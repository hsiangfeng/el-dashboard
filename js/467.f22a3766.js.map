{"version":3,"file":"js/467.f22a3766.js","mappings":"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","sources":["webpack://el-dashboard/./src/views/UserCheckout.vue","webpack://el-dashboard/./src/views/UserCheckout.vue?0c02"],"sourcesContent":["<template>\n  <ElRow justify=\"center\">\n    <ElCol :span=\"8\">\n      <h3>訂單資訊</h3>\n      <ElTable\n        :data=\"products\"\n        stripe\n        style=\"width: 100%\"\n        :show-summary=\"true\"\n        :summary-method=\"getSummary\"\n        sum-text=\"總計\"\n        v-loading=\"isLoading\"\n      >\n        <ElTableColumn prop=\"product.title\" label=\"品名\" />\n        <ElTableColumn prop=\"qty\" label=\"數量\">\n          <template #default=\"scope\">\n            {{ scope.row.qty }} / {{ scope.row.product.unit }}\n          </template>\n        </ElTableColumn>\n        <ElTableColumn prop=\"final_total\" label=\"單價\">\n          <template #default=\"scope\">\n            {{ $filters.currency(scope.row.final_total) }}\n          </template>\n        </ElTableColumn>\n      </ElTable>\n    </ElCol>\n  </ElRow>\n  <ElRow justify=\"center\" v-loading=\"isLoading\">\n    <ElCol :span=\"8\">\n      <h3>使用者資訊</h3>\n      <ElForm @submit.prevent=\"payOrder\" :label-position=\"'top'\">\n        <ElFormItem label=\"Email\">\n          <ElInput v-model=\"order.user.email\" disabled />\n        </ElFormItem>\n        <ElFormItem label=\"姓名\">\n          <ElInput v-model=\"order.user.name\" disabled />\n        </ElFormItem>\n        <ElFormItem label=\"電話\">\n          <ElInput v-model=\"order.user.tel\" disabled />\n        </ElFormItem>\n        <ElFormItem label=\"地址\">\n          <ElInput v-model=\"order.user.address\" disabled />\n        </ElFormItem>\n        <ElFormItem label=\"付款狀態\">\n          <ElTag :type=\"order.is_paid ? 'success' : 'info'\">\n            {{ order.is_paid ? '付款成功' : '尚未付款' }}\n          </ElTag>\n        </ElFormItem>\n        <div class=\"text-end\">\n          <ElButton\n            :native-type=\"'submit'\"\n            :type=\"order.is_paid ? 'success' : 'info'\"\n            :disabled=\"order.is_paid\"\n            plain\n          >\n            {{ order.is_paid ? '已付款' : '付款去' }}\n          </ElButton>\n        </div>\n      </ElForm>\n    </ElCol>\n  </ElRow>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      isLoading: false,\n      orderId: '',\n      order: {\n        user: {},\n      },\n      products: [],\n    };\n  },\n  methods: {\n    getOrder() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API_URL}/api/${process.env.VUE_APP_API_PATH}/order/${this.orderId}`;\n      this.$http.get(url)\n        .then((response) => {\n          this.order = response.data.order;\n          const { products } = response.data.order;\n\n          // 因為原始資料是物件，所以要重新轉成陣列\n          const cacheProducts = Object.keys(response.data.order.products).map(\n            (key) => ({\n              ...products[key],\n            }),\n          );\n          this.products = cacheProducts;\n          this.isLoading = false;\n        })\n        .catch((error) => {\n          this.isLoading = false;\n          this.$notify({\n            title: '錯誤訊息',\n            message: error.response.data.message,\n            type: 'error',\n          });\n        });\n    },\n    payOrder() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API_URL}/api/${process.env.VUE_APP_API_PATH}/pay/${this.orderId}`;\n      this.$http\n        .post(url)\n        .then(() => {\n          this.isLoading = false;\n          this.$notify({\n            title: '付款資訊',\n            message: '付款成功！',\n            type: 'success',\n          });\n          this.getOrder();\n        })\n        .catch((error) => {\n          this.isLoading = false;\n          this.$notify({\n            title: '錯誤訊息',\n            message: error.response.data.message,\n            type: 'error',\n          });\n        });\n    },\n    getSummary({ columns, data }) {\n      const sums = [];\n      // Element Plus 官方的範例程式碼\n      // https://element-plus.org/zh-CN/component/table.html#%E8%A1%A8%E5%B0%BE%E5%90%88%E8%AE%A1%E8%A1%8C\n      columns.forEach((column, index) => {\n        if (index === 0) {\n          sums[index] = '總計';\n          return;\n        }\n        const values = data.map((item) => Number(item[column.property]));\n        if (!values.every((value) => Number.isNaN(value))) {\n          const total = values.reduce((previousValue, currentValue) => previousValue + currentValue);\n          sums[index] = this.$filters.currency(total);\n        }\n      });\n      return sums;\n    },\n  },\n  mounted() {\n    this.orderId = this.$route.params.orderId;\n    this.getOrder();\n  },\n};\n</script>\n\n<style></style>\n","import { render } from \"./UserCheckout.vue?vue&type=template&id=b3f63dd0\"\nimport script from \"./UserCheckout.vue?vue&type=script&lang=js\"\nexport * from \"./UserCheckout.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/rayxu/el-dashboard/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","_createVNode","_component_ElRow","justify","_component_ElCol","span","_hoisted_1","_createBlock","_component_ElTable","data","$data","stripe","style","$options","_component_ElTableColumn","prop","label","default","scope","row","qty","_toDisplayString","product","unit","_ctx","currency","final_total","_hoisted_2","_component_ElForm","onSubmit","_component_ElFormItem","_component_ElInput","user","email","$event","disabled","name","tel","address","_component_ElTag","type","is_paid","_component_ElButton","plain","isLoading","orderId","order","products","methods","getOrder","this","url","$http","get","then","response","cacheProducts","Object","keys","map","key","catch","error","$notify","title","message","payOrder","post","getSummary","columns","sums","forEach","column","index","values","item","Number","property","every","value","isNaN","total","reduce","previousValue","currentValue","$filters","mounted","$route","params","__exports__","render"],"sourceRoot":""}