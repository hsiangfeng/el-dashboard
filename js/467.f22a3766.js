"use strict";(self["webpackChunkel_dashboard"]=self["webpackChunkel_dashboard"]||[]).push([[467],{4467:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var r=a(3396),d=a(7139),s=a(9242);const l=(0,r._)("h3",null,"訂單資訊",-1),o=(0,r._)("h3",null,"使用者資訊",-1),i={class:"text-end"};function u(e,t,a,u,n,p){const m=(0,r.up)("ElTableColumn"),c=(0,r.up)("ElTable"),h=(0,r.up)("ElCol"),f=(0,r.up)("ElRow"),w=(0,r.up)("ElInput"),y=(0,r.up)("ElFormItem"),b=(0,r.up)("ElTag"),g=(0,r.up)("ElButton"),_=(0,r.up)("ElForm"),W=(0,r.Q2)("loading");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(f,{justify:"center"},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{span:8},{default:(0,r.w5)((()=>[l,(0,r.wy)(((0,r.wg)(),(0,r.j4)(c,{data:n.products,stripe:"",style:{width:"100%"},"show-summary":!0,"summary-method":p.getSummary,"sum-text":"總計"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{prop:"product.title",label:"品名"}),(0,r.Wm)(m,{prop:"qty",label:"數量"},{default:(0,r.w5)((e=>[(0,r.Uk)((0,d.zw)(e.row.qty)+" / "+(0,d.zw)(e.row.product.unit),1)])),_:1}),(0,r.Wm)(m,{prop:"final_total",label:"單價"},{default:(0,r.w5)((t=>[(0,r.Uk)((0,d.zw)(e.$filters.currency(t.row.final_total)),1)])),_:1})])),_:1},8,["data","summary-method"])),[[W,n.isLoading]])])),_:1})])),_:1}),(0,r.wy)(((0,r.wg)(),(0,r.j4)(f,{justify:"center"},{default:(0,r.w5)((()=>[(0,r.Wm)(h,{span:8},{default:(0,r.w5)((()=>[o,(0,r.Wm)(_,{onSubmit:(0,s.iM)(p.payOrder,["prevent"]),"label-position":"top"},{default:(0,r.w5)((()=>[(0,r.Wm)(y,{label:"Email"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{modelValue:n.order.user.email,"onUpdate:modelValue":t[0]||(t[0]=e=>n.order.user.email=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(y,{label:"姓名"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{modelValue:n.order.user.name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.order.user.name=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(y,{label:"電話"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{modelValue:n.order.user.tel,"onUpdate:modelValue":t[2]||(t[2]=e=>n.order.user.tel=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(y,{label:"地址"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{modelValue:n.order.user.address,"onUpdate:modelValue":t[3]||(t[3]=e=>n.order.user.address=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(y,{label:"付款狀態"},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{type:n.order.is_paid?"success":"info"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,d.zw)(n.order.is_paid?"付款成功":"尚未付款"),1)])),_:1},8,["type"])])),_:1}),(0,r._)("div",i,[(0,r.Wm)(g,{"native-type":"submit",type:n.order.is_paid?"success":"info",disabled:n.order.is_paid,plain:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,d.zw)(n.order.is_paid?"已付款":"付款去"),1)])),_:1},8,["type","disabled"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1})),[[W,n.isLoading]])],64)}var n={data(){return{isLoading:!1,orderId:"",order:{user:{}},products:[]}},methods:{getOrder(){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/teaching-example/order/${this.orderId}`;this.$http.get(e).then((e=>{this.order=e.data.order;const{products:t}=e.data.order,a=Object.keys(e.data.order.products).map((e=>({...t[e]})));this.products=a,this.isLoading=!1})).catch((e=>{this.isLoading=!1,this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})}))},payOrder(){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/teaching-example/pay/${this.orderId}`;this.$http.post(e).then((()=>{this.isLoading=!1,this.$notify({title:"付款資訊",message:"付款成功！",type:"success"}),this.getOrder()})).catch((e=>{this.isLoading=!1,this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})}))},getSummary({columns:e,data:t}){const a=[];return e.forEach(((e,r)=>{if(0===r)return void(a[r]="總計");const d=t.map((t=>Number(t[e.property])));if(!d.every((e=>Number.isNaN(e)))){const e=d.reduce(((e,t)=>e+t));a[r]=this.$filters.currency(e)}})),a}},mounted(){this.orderId=this.$route.params.orderId,this.getOrder()}},p=a(89);const m=(0,p.Z)(n,[["render",u]]);var c=m}}]);
//# sourceMappingURL=467.f22a3766.js.map