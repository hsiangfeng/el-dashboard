"use strict";(self["webpackChunkel_dashboard"]=self["webpackChunkel_dashboard"]||[]).push([[491],{7659:function(e,t,l){l.d(t,{Z:function(){return n}});var a=l(3396),o=l(7139);const d=(0,a.Uk)("取消"),i=(0,a.Uk)("刪除");function u(e,t,l,u,p,r){const s=(0,a.up)("ElButton"),n=(0,a.up)("ElDialog");return(0,a.wg)(),(0,a.j4)(n,{modelValue:p.dialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>p.dialogVisible=e),title:"刪除",width:"50%"},{footer:(0,a.w5)((()=>[(0,a.Wm)(s,{type:"info",onClick:t[0]||(t[0]=e=>p.dialogVisible=!1),plain:""},{default:(0,a.w5)((()=>[d])),_:1}),(0,a.Wm)(s,{type:"danger",onClick:r.onClick,plain:""},{default:(0,a.w5)((()=>[i])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a._)("h3",null,"你確定要刪除 "+(0,o.zw)(l.data.title||l.data.id)+"(刪除後將無法恢復)。",1)])),_:1},8,["modelValue"])}var p={props:["data"],emits:["delete"],data(){return{dialogVisible:!1}},methods:{onClick(){this.$emit("delete",this.data.id)}}},r=l(89);const s=(0,r.Z)(p,[["render",u]]);var n=s},4491:function(e,t,l){l.r(t),l.d(t,{default:function(){return U}});var a=l(3396),o=l(7139);const d=(0,a._)("h3",null,"產品列表",-1),i={class:"text-end"},u=(0,a.Uk)("新增產品"),p=(0,a.Uk)("編輯"),r=(0,a.Uk)("刪除");function s(e,t,l,s,n,m){const c=(0,a.up)("ElButton"),h=(0,a.up)("ElTableColumn"),f=(0,a.up)("ElTag"),g=(0,a.up)("ElTable"),w=(0,a.up)("ProductModal"),_=(0,a.up)("DeleteModal"),b=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[d,(0,a._)("div",i,[(0,a.Wm)(c,{type:"primary",plain:"",onClick:t[0]||(t[0]=e=>m.openModal(!0))},{default:(0,a.w5)((()=>[u])),_:1})]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(g,{data:n.products,stripe:"",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{prop:"category",label:"分類",width:"150"}),(0,a.Wm)(h,{prop:"title",label:"標題"}),(0,a.Wm)(h,{prop:"origin_price",label:"原價",width:"100"},{default:(0,a.w5)((t=>[(0,a.Uk)((0,o.zw)(e.$filters.currency(t.row.origin_price)),1)])),_:1}),(0,a.Wm)(h,{prop:"price",label:"售價",width:"100"},{default:(0,a.w5)((t=>[(0,a.Uk)((0,o.zw)(e.$filters.currency(t.row.origin_price)),1)])),_:1}),(0,a.Wm)(h,{label:"是否啟用",width:"100"},{default:(0,a.w5)((e=>[(0,a.Wm)(f,{type:e.row.is_enabled?"success":"info"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.is_enabled?"啟用":"未啟用"),1)])),_:2},1032,["type"])])),_:1}),(0,a.Wm)(h,{label:"功能",width:"150"},{default:(0,a.w5)((e=>[(0,a.Wm)(c,{type:"primary",plain:"",size:"small",onClick:t=>m.openModal(!1,e.row)},{default:(0,a.w5)((()=>[p])),_:2},1032,["onClick"]),(0,a.Wm)(c,{type:"danger",plain:"",size:"small",onClick:t=>m.openDeleteModal(e.row)},{default:(0,a.w5)((()=>[r])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[b,n.isLoading]]),(0,a.Wm)(w,{ref:"ProductModalRef","is-new":n.isNew,product:n.tempProduct,onUpdateProduct:m.updateProduct},null,8,["is-new","product","onUpdateProduct"]),(0,a.Wm)(_,{ref:"DeleteModalRef",data:n.tempProduct,onDelete:m.deleteProduct},null,8,["data","onDelete"])],64)}var n=l(9242);const m=(0,a.Uk)("Click to upload"),c=(0,a._)("h3",null,"圖片預覽",-1),h=(0,a.Uk)("取消"),f=(0,a.Uk)("送出");function g(e,t,l,o,d,i){const u=(0,a.up)("ElInput"),p=(0,a.up)("ElFormItem"),r=(0,a.up)("ElButton"),s=(0,a.up)("ElUpload"),g=(0,a.up)("ElImage"),w=(0,a.up)("ElCol"),_=(0,a.up)("ElCheckbox"),b=(0,a.up)("ElRow"),W=(0,a.up)("ElForm"),y=(0,a.up)("ElDialog"),V=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.j4)(y,{modelValue:d.dialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>d.dialogVisible=e),title:l.isNew?"產品新增":"產品編輯",center:"",width:"50%","close-on-click-modal":!1},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{onSubmit:(0,n.iM)(i.onSubmit,["prevent"]),"label-position":"top"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{gutter:30},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{md:6},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"圖片連結"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{modelValue:d.tempProduct.imageUrl,"onUpdate:modelValue":t[0]||(t[0]=e=>d.tempProduct.imageUrl=e),placeholder:"請輸入圖片連結"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(p,{label:"圖片上傳"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{action:"/","before-upload":i.uploadFile},{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(r,{type:"primary",plain:""},{default:(0,a.w5)((()=>[m])),_:1})),[[V,d.fileUploading]])])),_:1},8,["before-upload"])])),_:1}),c,(0,a.Wm)(g,{src:d.tempProduct.imageUrl,style:{width:"100%",height:"200px"},fit:"cover"},null,8,["src"])])),_:1}),(0,a.Wm)(w,{md:18},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{gutter:15},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{md:12},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"產品標題"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"text",modelValue:d.tempProduct.title,"onUpdate:modelValue":t[1]||(t[1]=e=>d.tempProduct.title=e),placeholder:"請輸入產品標題"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:12},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"產品分類"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"text",modelValue:d.tempProduct.category,"onUpdate:modelValue":t[2]||(t[2]=e=>d.tempProduct.category=e),placeholder:"請輸入產品分類"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:8},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"單位"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"text",modelValue:d.tempProduct.unit,"onUpdate:modelValue":t[3]||(t[3]=e=>d.tempProduct.unit=e),placeholder:"請輸入產品單位"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:8},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"原價"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"number",modelValue:d.tempProduct.origin_price,"onUpdate:modelValue":t[4]||(t[4]=e=>d.tempProduct.origin_price=e),modelModifiers:{number:!0},placeholder:"請輸入產品原價"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:8},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"售價"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"number",modelValue:d.tempProduct.price,"onUpdate:modelValue":t[5]||(t[5]=e=>d.tempProduct.price=e),modelModifiers:{number:!0},placeholder:"請輸入產品售價"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:24},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"產品描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"textarea",modelValue:d.tempProduct.description,"onUpdate:modelValue":t[6]||(t[6]=e=>d.tempProduct.description=e),placeholder:"產品描述"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:24},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"說明內容"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{type:"textarea",modelValue:d.tempProduct.content,"onUpdate:modelValue":t[7]||(t[7]=e=>d.tempProduct.content=e),placeholder:"產品描述"},null,8,["modelValue"])])),_:1})])),_:1}),(0,a.Wm)(w,{md:24},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{class:"text-end",modelValue:d.tempProduct.is_enabled,"onUpdate:modelValue":t[8]||(t[8]=e=>d.tempProduct.is_enabled=e),label:"是否啟用",size:"large"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(w,{class:"text-end",md:24},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"info",onClick:t[9]||(t[9]=e=>d.dialogVisible=!1),plain:""},{default:(0,a.w5)((()=>[h])),_:1}),(0,a.Wm)(r,{"native-type":"submit",type:"primary",plain:""},{default:(0,a.w5)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["modelValue","title"])}var w={props:["isNew","product"],emits:["update-product"],data(){return{dialogVisible:!1,tempProduct:{},fileUploading:!1}},methods:{uploadFile(e){this.fileUploading=!0;const t=new FormData;t.append("file-to-upload",e);const l="https://vue3-course-api.hexschool.io/v2/api/teaching-example/admin/upload";return this.$http.post(l,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{this.fileUploading=!1,e.data.success?(this.tempProduct.imageUrl=e.data.imageUrl,this.$notify({title:"上傳結果",message:"圖片上傳成功！",type:"success"})):this.$notify({title:"上傳結果",message:e.data.message,type:"error"})})).catch((e=>{this.fileUploading=!1,this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})})),!1},onSubmit(){this.$emit("update-product",this.tempProduct)}},watch:{product(){this.tempProduct=this.product}}},_=l(89);const b=(0,_.Z)(w,[["render",g]]);var W=b,y=l(7659),V={data(){return{products:[],pagination:{},tempProduct:{},isNew:!0,isLoading:!1}},components:{ProductModal:W,DeleteModal:y.Z},methods:{getProducts(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/v2/api/teaching-example/admin/products";this.$http.get(e).then((e=>{this.products=e.data.products,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{this.isLoading=!1,this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})}))},openModal(e,t){this.isNew=e,this.tempProduct=e?{is_enabled:0}:{...t},this.$refs.ProductModalRef.dialogVisible=!0},openDeleteModal(e){this.tempProduct={...e},this.$refs.DeleteModalRef.dialogVisible=!0},updateProduct(e){let t="https://vue3-course-api.hexschool.io/v2/api/teaching-example/admin/product";this.isLoading=!0;let l="post",a="新增產品";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/teaching-example/admin/product/${this.tempProduct.id}`,l="put",a="更新產品"),this.$http[l](t,{data:e}).then((()=>{this.$refs.ProductModalRef.dialogVisible=!1,this.$notify({title:a,message:"執行成功！",type:"success"}),this.getProducts()})).catch((e=>{this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})}))},deleteProduct(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/teaching-example/admin/product/${e}`;this.$http.delete(t).then((()=>{this.$refs.DeleteModalRef.dialogVisible=!1,this.$notify({title:"產品刪除",message:"刪除成功！",type:"success"}),this.isLoading=!1,this.getProducts()})).catch((e=>{this.isLoading=!1,this.$notify({title:"錯誤訊息",message:e.response.data.message,type:"error"})}))}},mounted(){this.getProducts()}};const P=(0,_.Z)(V,[["render",s]]);var U=P}}]);
//# sourceMappingURL=491.07f518d6.js.map